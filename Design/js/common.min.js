angular.module("ngApp").filter("commaOrdinal",function(){return function(e){return e?e+",":""}}),angular.module("ngApp").filter("ToInt",["$filter",function(e){return function(e){return e?(e=parseFloat(e),""+(e=e.toFixed(e%1==0?0:2)).toString().replace(/\B(?=(\d{3})+(?!\d))/g,"")):"0"}}]),angular.module("ngApp").factory("Account",["$timeout","$q","$http",function(e,t,n){return new function(){var e;this.me=function(){var r=t.defer();return n.get("/account/me/").then(function(t){e=t.data,r.resolve(angular.copy(e))}).catch(function(e){r.reject(e)}),r.promise}}}]),angular.module("ngApp").factory("plowerHelper",["$window","$cookies","$httpParamSerializer","Utils",function(e,t,n,r){function o(){}return o.prototype={clean:function(e){for(var t in e)""!==e[t]&&void 0!==e[t]||delete e[t];var n={ReferrerInPagePosition:Number,ReferrerSectionItemPosition:Number,ReferrerTypeID:Number,ScreenTypeID:Number,ResultsCount:Number};for(var t in n)void 0!==e[t]&&(e[t]=n[t](e[t]));return e},isTablet:function(){return e.innerWidth>767&&e.innerWidth<991},deviceType:function(){return e.innerWidth>767?"desktopWeb":t.get("User-Agent")?"App":"mobileWeb"},appVersion:function(){var e=t.get("User-Agent");return e?e.split("/")[1]:"Web"},getServerTime:function(){return t.get("ts").replace(/\"/g,"")},getCityId:function(){return Number(t.get("_bb_cid"))},getHubId:function(){return Number(t.get("_bb_hid"))||1},getVisitorId:function(){return(t.get("_bb_vid")||"1").replace(/\"/g,"")},getMemberId:function(){return(t.get("_bb_mid")||"").replace(/\"/g,"")},storageAvailable:function(e){try{var t=window[e],n="__storage_test__";return t.setItem(n,n),t.removeItem(n),!0}catch(e){return console.error("Too sad Snowplow partial support. No localstorage found"),!1}},today:function(){return(new Date).toDateString()},saveCurrentScreen:function(e){this.storageAvailable("localStorage")&&(e.schema&&delete e.schema,e.ReferrerSlug=e.ScreenSlug,e.ReferrerURL=e.ScreenURL,e.ReferrerType=e.ScreenType,window.localStorage.setItem(this.today(),JSON.stringify(e)))},getLastScreen:function(){return this.storageAvailable("localStorage")?JSON.parse(window.localStorage.getItem(this.today())||"{}"):{}},getUTMString:function(){var e,t={utm_source:"",utm_medium:"",utm_campaign:"",utm_term:"",utm_content:""},o=!0;for(var c in t)(e=r.getSearchQueryParam(c))&&(o=!1,t[c]=e);return o?"":n(t)}},new o}]);var SPEvents={checkout:{address_slot_shown:{EventName:"Checkout_AddressSlotShown",EventSubGroup:"AddressSlot",Action:"AddressSlotShown",InitialFI:""},delivery_address_added:{EventName:"Checkout_AddAddress",EventSubGroup:"checkoutAddress",Action:"AddAddress"},delivery_address_changed:{EventName:"Checkout_ChangeAddress",EventSubGroup:"checkoutAddress",Action:"ChangeAddress",InitialCityID:0,FinalCityID:0},delivery_address_selected:{EventName:"Checkout_AddressSelected",EventSubGroup:"checkoutAddress",Action:"DeliveryAddress"},qc_shown:{EventName:"Checkout_QCShown",EventSubGroup:"QC",Action:"QCShown",NoOfItemsAvailable:0,NoOfItemsPartiallyAvailable:0,NoOfItemsNotAvailable:0,ItemsNotAvailable:[],ItemsPartiallyAvailable:[]},qc_continue_clicked:{EventName:"QC_Continue",EventSubGroup:"QC",Action:"QCcontinue",NoOfItemsAvailable:0,NoOfItemsPartiallyAvailable:0,NoOfItemsNotAvailable:0,ItemsNotAvailable:[],ItemsPartiallyAvailable:[]},non_default_delivery_option_clicked:{EventName:"Checkout_DeliveryOptionsChanged",EventSubGroup:"DeliveryOptions",Action:"DeliveryOptionsContinue",InitialFI:"",FinalFI:""},proceed_to_pay_clicked:{EventName:"Checkout_DeliveryOptionsSelected",EventSubGroup:"DeliveryOptions",Action:"DeliveryOptionsSelected",InitialFI:"",FinalFI:""},gifting_shown:{EventName:"Checkout_GiftShown",EventSubGroup:"gifting",Action:"giftingShown",NoOfGiftItems:0},save_gifting:{EventName:"Checkout_GiftSave",EventSubGroup:"gifting",Action:"giftingSave",NoOfGiftItems:0},payment_shown:{EventName:"Checkout_PaymentShown",EventSubGroup:"payment",Action:"shown",PaymentMode:""},vouchers_shown:{EventName:"Checkout_VoucherShown",EventSubGroup:"payment",Action:"showVouchers"},voucher_applied:{EventName:"Checkout_VoucherApplied",EventSubGroup:"payment",Action:"voucherApplied",VoucherCode:""},voucher_apply_failed:{EventName:"Checkout_VoucherApplyFailed",EventSubGroup:"payment",Action:"voucherError",VoucherCode:"",FailureReason:""},bbwallet_uncheked:{EventName:"Checkout_WalletUnChecked",EventSubGroup:"payment",Action:"uncheckWallet"},bbwallet_checked:{EventName:"Checkout_WalletChecked",EventSubGroup:"payment",Action:"checkWallet"},place_order_clicked:{EventName:"Checkout_PlaceOrderClicked",EventSubGroup:"placeorderclicked",Action:"PlaceOrderClicked"},error:{EventName:"Checkout_Errors",EventSubGroup:"",Action:"checkoutErrors",FailureReason:""},view_shipment_items:{EventName:"Checkout_ViewShipmentItems",EventSubGroup:"DeliveryOptions",Action:"ShipmentItemsShown",NoOfItemsAvailable:0,FinalFI:""},checkout_address_shown:{EventName:"Checkout_AddressShown",EventSubGroup:"checkoutAddress",Action:"shown"},qc_review_clicked:{EventName:"Checkout_QCReview",EventSubGroup:"QC",Action:"QCreview",NoOfItemsAvailable:0,NoOfItemsPartiallyAvailable:0,NoOfItemsNotAvailable:0,ItemsNotAvailable:[],ItemsPartiallyAvailable:[]},gift_delete:{EventName:"Checkout_GiftMessageDelete",EventSubGroup:"gifting",Action:"messageDelete",NoOfGiftItems:0},voucher_removed:{EventName:"Checkout_VoucherRemoved",EventSubGroup:"payment",Action:"voucherRemoved",VoucherCode:"",VoucherDiscountAmt:0},remove_items_confirm:{EventName:"Checkout_RemoveShipmentItemsConfirm",EventSubGroup:"DeliveryOptions",Action:"ShipmentItemsRemoved",ItemsRemoved:[],FinalFI:""}}},SPSCHEMA_MAP={checkout:"iglu:com.bigbasket/checkout_interactions/jsonschema/1-0-0"};for(var evt_group in SPEvents)for(var evt_id in SPEvents[evt_group])SPEvents[evt_group][evt_id].schema=SPSCHEMA_MAP[evt_group];var SPScreenViews={checkout:{delivery_options:{EventName:"Checkout_AddressSlotShown",ScreenType:"coaddressslot",ScreenURL:"",ScreenSlug:"/co/checkout/coaddressslot",ReferrerURL:"",ReferrerSlug:"/basket",ReferrerType:"basket",PageTemplate:"default"},qc_popup:{EventName:"Checkout_QCShown",ScreenType:"coqc",ScreenURL:"",ScreenSlug:"/co/checkout/qc/",ReferrerURL:"",ReferrerSlug:"/co/checkout/address/",ReferrerType:"coaddressslot",PageTemplate:"default"},gift_section:{EventName:"Checkout_GiftShown",ScreenType:"cogift",ScreenURL:"",ScreenSlug:"/co/checkout/gift",ReferrerURL:"",ReferrerSlug:"/co/checkout/delivery/",ReferrerType:"coaddressslot",PageTemplate:"default"},payment_section:{EventName:"Checkout_PaymentShown",ScreenType:"copayment",ScreenURL:"",ScreenSlug:"/co/checkout/payment",ReferrerURL:"",ReferrerSlug:"/co/checkout/delivery",ReferrerType:"coaddressslot",PageTemplate:"default"},vouchers_popup:{EventName:"Checkout_VoucherShown",ScreenType:"covoucher",ScreenURL:"",ScreenSlug:"/co/checkout/voucher",ReferrerURL:"",ReferrerSlug:"/co/checkout/payment",ReferrerType:"copayment",PageTemplate:"default"},shipment_items_popup:{EventName:"Checkout_ViewShipmentItems",ScreenType:"coitems",ScreenURL:"",ScreenSlug:"/co/checkout/coitems",ReferrerURL:"",ReferrerSlug:"/co/checkout/payment",ReferrerType:"copayment",PageTemplate:"default"},address_listing:{EventName:"Checkout_AddressShown",ScreenType:"coaddress",ScreenURL:"",ScreenSlug:"/co/checkout/address",ReferrerURL:"/basket/",ReferrerSlug:"/basket/",ReferrerType:"basket",PageTemplate:"default"}}},SCREEN_VIEW_SCHEMA="iglu:com.bigbasket/screen_views/jsonschema/1-0-0";for(var screen_group in SPScreenViews)for(var screen_id in SPScreenViews[screen_group])SPScreenViews[screen_group][screen_id].schema=SCREEN_VIEW_SCHEMA;angular.module("ngApp").factory("BBScreenView",["$window","$timeout","BBSnowPlow","Utils","plowerHelper",function(e,t,n,r,o){return new function(){this.init=function(){},this.send=function(e){var t=o.getLastScreen();t&&(e.ReferrerSlug=t.ScreenSlug,e.ReferrerURL=t.ScreenURL,e.ReferrerType=t.ScreenType),e.ScreenURL=window.location.origin+e.ScreenSlug;var r=Object.assign({},e);o.saveCurrentScreen(r),n.sendEvent(e)}}}]),angular.module("ngApp").factory("ScreenViewsReferrals",function(){return new function(){}}),angular.module("ngApp").factory("BBSnowPlow",["$window","$timeout","plowerHelper","ScreenViewsReferrals",function(e,t,n,r){return new function(){var e,r,o,c,a=!1,i=this;this.init=function(t){if(t.is_enabled){window.snowplow("newTracker","cf",t.collector,{appId:"B2CWebApp",namespace:"Web",encodeBase64:!1,cookieDomain:"bigbasket"});var r={EventChannel:"snowplow",TrueTimestamp:n.getServerTime(),AppVersion:n.appVersion(),DeviceType:n.deviceType(),IsTablet:n.isTablet(),UtmString:n.getUTMString(),CityId:n.getCityId(),HubId:n.getHubId(),Vid:n.getVisitorId(),Mid:n.getMemberId()};e={schema:"iglu:com.bigbasket/bb_context/jsonschema/1-0-0",data:r},a=!0}},this.getContext=function(){return e},this.sendEvent=function(e,t){var c=n.clean(angular.copy(e));r?(r.next={base_evt:c,data:t},r=r.next):o={next:r={base_evt:c,data:t}},this.publish()},this.publish=function(){a&&(c||(window.snowplow?(c=!0,u()):t(function(){i.publish()},100)))};var u=function(){o.next?t(function(){var e=o.next,n=angular.copy(e.base_evt),r=e.data||{};for(var c in r)n[c]=r[c];var a=n.schema;delete n.schema;var s={data:n,schema:a};window.snowplow("trackUnstructEvent",s,i.getContext()),o=e,t(u,1)},0):c=!1}}}]),angular.module("ngApp").factory("Utils",["$window","$cookies",function(e,t){function n(){}return n.prototype={isEmpty:function(e){return 0===Object.keys(e||{}).length},getSearchQueryParam:function(e,t){var n=t||window.location.href;e=e.replace(/[\[\]]/g,"\\$&");var r=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)").exec(n);return r&&r[2]?decodeURIComponent(r[2].replace(/\+/g," ")):""}},new n}]),angular.module("ngApp").factory("Env",["$q","$http",function(e,t){var n={DESKTOP_WEB:"desktop-web",PWA:"pwa",MOBILE_WV:"mobile-wv"};return new function(){this.isMobileWV=function(){return _g_env.platform===n.MOBILE_WV},this.isDesktopWeb=function(){return _g_env.platform===n.DESKTOP_WEB}}}]),angular.module("ngApp").factory("GA",function(){return{push:function(e){var t=e[0];if("_trackEvent"===t){var n=e[1],r=e[2],o=e[3],c=e[4];c?ga("send","event",n,r,o,c,{nonInteraction:1}):ga("send","event",n,r,o,{nonInteraction:1})}"_addTrans"===t&&(ga("ecommerce:addTransaction",{id:e[1],affiliation:"BigBasket.com",revenue:e[3],shipping:e[5],tax:e[4]}),ga("ecommerce:send")),"_addItem"===t&&(ga("ecommerce:addItem",{id:e[1],name:e[3],sku:e[2],category:e[4],price:e[5],quantity:e[6]}),ga("ecommerce:send"))}}});